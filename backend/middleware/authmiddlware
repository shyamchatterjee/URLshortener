const User = require("../model/userscema");
let jwt = require("jsonwebtoken");
let verifyTokenMiddleware = async (req, res, next) => {
  if (!req.cookies.token) {
    return res
      .status(404)
      .json({ ok: false, massage: "You are not login, Plaese login" });
  }

  let verify = jwt.verify(req.cookies.token, process.env.SECRET_KEY);
  let finddeta = await User.findById(verify);
  if (!finddeta) {
    return res.status(404).json({ ok: false, massage: "Unvalied token" });
  }
  req.user = finddeta.id;
  return next();
};
module.exports = verifyTokenMiddleware;
